{"ast":null,"code":"import _toConsumableArray from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/tuguldursaikhan/Desktop/kaizen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/tuguldursaikhan/Desktop/kaizen/src/routes/components/dataDisplay/Tree/Dragable.js\";\nimport React from \"react\";\nimport { Card, Tree } from \"antd\";\nvar TreeNode = Tree.TreeNode;\nvar x = 3;\nvar y = 2;\nvar z = 1;\nvar gData = [];\n\nvar generateData = function generateData(_level, _preKey, _tns) {\n  var preKey = _preKey || '0';\n  var tns = _tns || gData;\n  var children = [];\n\n  for (var i = 0; i < x; i++) {\n    var key = \"\".concat(preKey, \"-\").concat(i);\n    tns.push({\n      title: key,\n      key: key\n    });\n\n    if (i < y) {\n      children.push(key);\n    }\n  }\n\n  if (_level < 0) {\n    return tns;\n  }\n\n  var level = _level - 1;\n  children.forEach(function (key, index) {\n    tns[index].children = [];\n    return generateData(level, key, tns[index].children);\n  });\n};\n\ngenerateData(z);\n\nvar Dragable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Dragable, _React$Component);\n\n  function Dragable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Dragable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Dragable)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      gData: gData,\n      expandedKeys: ['0-0', '0-0-0', '0-0-0-0']\n    };\n\n    _this.onDragEnter = function (info) {\n      console.log(info); // expandedKeys 需要受控时设置\n      // this.setState({\n      //   expandedKeys: info.expandedKeys,\n      // });\n    };\n\n    _this.onDrop = function (info) {\n      console.log(info);\n      var dropKey = info.node.props.eventKey;\n      var dragKey = info.dragNode.props.eventKey;\n      var dropPos = info.node.props.pos.split('-');\n      var dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]); // const dragNodesKeys = info.dragNodesKeys;\n\n      var loop = function loop(data, key, callback) {\n        data.forEach(function (item, index, arr) {\n          if (item.key === key) {\n            return callback(item, index, arr);\n          }\n\n          if (item.children) {\n            return loop(item.children, key, callback);\n          }\n        });\n      };\n\n      var data = _toConsumableArray(_this.state.gData);\n\n      var dragObj;\n      loop(data, dragKey, function (item, index, arr) {\n        arr.splice(index, 1);\n        dragObj = item;\n      });\n\n      if (info.dropToGap) {\n        var ar;\n        var i;\n        loop(data, dropKey, function (item, index, arr) {\n          ar = arr;\n          i = index;\n        });\n\n        if (dropPosition === -1) {\n          ar.splice(i, 0, dragObj);\n        } else {\n          ar.splice(i + 1, 0, dragObj);\n        }\n      } else {\n        loop(data, dropKey, function (item) {\n          item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置\n\n          item.children.push(dragObj);\n        });\n      }\n\n      _this.setState({\n        gData: data\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Dragable, [{\n    key: \"render\",\n    value: function render() {\n      var loop = function loop(data) {\n        return data.map(function (item) {\n          if (item.children && item.children.length) {\n            return React.createElement(TreeNode, {\n              key: item.key,\n              title: item.key,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 97\n              },\n              __self: this\n            }, loop(item.children));\n          }\n\n          return React.createElement(TreeNode, {\n            key: item.key,\n            title: item.key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99\n            },\n            __self: this\n          });\n        });\n      };\n\n      return React.createElement(Card, {\n        title: \"Dragable\",\n        className: \"gx-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(Tree, {\n        className: \"draggable-tree\",\n        defaultExpandedKeys: this.state.expandedKeys,\n        draggable: true,\n        onDragEnter: this.onDragEnter,\n        onDrop: this.onDrop,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, loop(this.state.gData)));\n    }\n  }]);\n\n  return Dragable;\n}(React.Component);\n\nexport default Dragable;","map":{"version":3,"sources":["/home/tuguldursaikhan/Desktop/kaizen/src/routes/components/dataDisplay/Tree/Dragable.js"],"names":["React","Card","Tree","TreeNode","x","y","z","gData","generateData","_level","_preKey","_tns","preKey","tns","children","i","key","push","title","level","forEach","index","Dragable","state","expandedKeys","onDragEnter","info","console","log","onDrop","dropKey","node","props","eventKey","dragKey","dragNode","dropPos","pos","split","dropPosition","Number","length","loop","data","callback","item","arr","dragObj","splice","dropToGap","ar","setState","map","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {Card, Tree} from \"antd\";\n\nconst TreeNode = Tree.TreeNode;\n\nconst x = 3;\nconst y = 2;\nconst z = 1;\nconst gData = [];\n\n\nconst generateData = (_level, _preKey, _tns) => {\n  const preKey = _preKey || '0';\n  const tns = _tns || gData;\n\n  const children = [];\n  for (let i = 0; i < x; i++) {\n    const key = `${preKey}-${i}`;\n    tns.push({title: key, key});\n    if (i < y) {\n      children.push(key);\n    }\n  }\n  if (_level < 0) {\n    return tns;\n  }\n  const level = _level - 1;\n  children.forEach((key, index) => {\n    tns[index].children = [];\n    return generateData(level, key, tns[index].children);\n  });\n};\ngenerateData(z);\n\nclass Dragable extends React.Component {\n  state = {\n    gData,\n    expandedKeys: ['0-0', '0-0-0', '0-0-0-0'],\n  };\n  onDragEnter = (info) => {\n    console.log(info);\n    // expandedKeys 需要受控时设置\n    // this.setState({\n    //   expandedKeys: info.expandedKeys,\n    // });\n  };\n  onDrop = (info) => {\n    console.log(info);\n    const dropKey = info.node.props.eventKey;\n    const dragKey = info.dragNode.props.eventKey;\n    const dropPos = info.node.props.pos.split('-');\n    const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\n    // const dragNodesKeys = info.dragNodesKeys;\n    const loop = (data, key, callback) => {\n      data.forEach((item, index, arr) => {\n        if (item.key === key) {\n          return callback(item, index, arr);\n        }\n        if (item.children) {\n          return loop(item.children, key, callback);\n        }\n      });\n    };\n    const data = [...this.state.gData];\n    let dragObj;\n    loop(data, dragKey, (item, index, arr) => {\n      arr.splice(index, 1);\n      dragObj = item;\n    });\n    if (info.dropToGap) {\n      let ar;\n      let i;\n      loop(data, dropKey, (item, index, arr) => {\n        ar = arr;\n        i = index;\n      });\n      if (dropPosition === -1) {\n        ar.splice(i, 0, dragObj);\n      } else {\n        ar.splice(i + 1, 0, dragObj);\n      }\n    } else {\n      loop(data, dropKey, (item) => {\n        item.children = item.children || [];\n        // where to insert 示例添加到尾部，可以是随意位置\n        item.children.push(dragObj);\n      });\n    }\n    this.setState({\n      gData: data,\n    });\n  };\n\n  render() {\n    const loop = data => data.map((item) => {\n      if (item.children && item.children.length) {\n        return <TreeNode key={item.key} title={item.key}>{loop(item.children)}</TreeNode>;\n      }\n      return <TreeNode key={item.key} title={item.key}/>;\n    });\n    return (\n      <Card title=\"Dragable\" className=\"gx-card\">\n        <Tree\n          className=\"draggable-tree\"\n          defaultExpandedKeys={this.state.expandedKeys}\n          draggable\n          onDragEnter={this.onDragEnter}\n          onDrop={this.onDrop}\n        >\n          {loop(this.state.gData)}\n        </Tree>\n      </Card>\n    );\n  }\n}\n\n\nexport default Dragable;\n"]},"metadata":{},"sourceType":"module"}